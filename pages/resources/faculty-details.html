<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Faculty & Staff Details - Poornimites</title>
    <link rel="stylesheet" href="../../assets/css/core/style.css">
    <link rel="stylesheet" href="../../assets/css/core/header.css">
    <link rel="stylesheet" href="../../assets/css/modules/resources/faculty-details.css">
</head>

<body>
    <div id="header-placeholder"></div>
  <script src="/scripts/header-loader.js?v=2.0"></script>

    <div class="faculty-container">
        <div class="page-header">
            <h1>?? Faculty & Staff Directory</h1>
            <p>Meet the amazing people who make our institution great</p>
        </div>

        <div class="controls-section">
            <div class="search-bar">
                <input type="text" class="search-input" id="searchInput"
                    placeholder="?? Search by name, department, or role...">
            </div>
            <div class="filter-buttons">
                <button class="filter-btn active" data-category="all"><span>All Members</span></button>
                <button class="filter-btn" data-category="chairman"><span>Chairman</span></button>
                <button class="filter-btn" data-category="hod"><span>HODs</span></button>
                <button class="filter-btn" data-category="faculty"><span>Faculty</span></button>
                <button class="filter-btn" data-category="admin"><span>Admin Staff</span></button>
                <button class="filter-btn" data-category="support"><span>Support Staff</span></button>
            </div>
        </div>

        <div class="faculty-grid" id="facultyGrid">
            <!-- Faculty cards will be dynamically inserted here -->
        </div>

        <div class="empty-state" id="emptyState" style="display: none;">
            <div class="empty-state-icon">??</div>
            <h3>No Results Found</h3>
            <p>Try adjusting your search or filter criteria</p>
        </div>
    </div>

    <script type="module">
        // Faculty and Staff Data
        const facultyData = [
            // Chairman
            {
                name: "Dr. Shashikala Gurpur",
                role: "Chairman",
                category: "chairman",
                department: "Administration",
                emoji: "??",
                experience: "30+ years",
                qualification: "Ph.D. in Management",
                email: "chairman@poornima.org",
                phone: "+91-141-2700500",
                specialization: ["Strategic Planning", "Educational Leadership", "Institution Building"],
                rating: 4.9,
                ratingCount: 156
            },

            // HODs
            {
                name: "Dr. Rajesh Kumar Sharma",
                role: "Head of Department",
                category: "hod",
                department: "Computer Science & Engineering",
                emoji: "??",
                experience: "18 years",
                qualification: "Ph.D. in Computer Science",
                email: "hod.cse@poornima.org",
                phone: "+91-141-2700520",
                specialization: ["Machine Learning", "Data Science", "Cloud Computing"],
                rating: 4.7,
                ratingCount: 234
            },
            {
                name: "Dr. Priya Mathur",
                role: "Head of Department",
                category: "hod",
                department: "Electronics & Communication",
                emoji: "??",
                experience: "16 years",
                qualification: "Ph.D. in Electronics Engineering",
                email: "hod.ece@poornima.org",
                phone: "+91-141-2700521",
                specialization: ["VLSI Design", "Embedded Systems", "Signal Processing"],
                rating: 4.8,
                ratingCount: 198
            },
            {
                name: "Dr. Amit Verma",
                role: "Head of Department",
                category: "hod",
                department: "Mechanical Engineering",
                emoji: "??",
                experience: "20 years",
                qualification: "Ph.D. in Mechanical Engineering",
                email: "hod.mech@poornima.org",
                phone: "+91-141-2700522",
                specialization: ["Thermal Engineering", "CAD/CAM", "Manufacturing"],
                rating: 4.6,
                ratingCount: 167
            },
            {
                name: "Dr. Sunita Agarwal",
                role: "Head of Department",
                category: "hod",
                department: "Civil Engineering",
                emoji: "???",
                experience: "15 years",
                qualification: "Ph.D. in Civil Engineering",
                email: "hod.civil@poornima.org",
                phone: "+91-141-2700523",
                specialization: ["Structural Engineering", "Geotechnical", "Transportation"],
                rating: 4.7,
                ratingCount: 142
            },

            // Faculty Members - CSE
            {
                name: "Prof. Vikram Singh",
                role: "Associate Professor",
                category: "faculty",
                department: "Computer Science & Engineering",
                emoji: "?????",
                experience: "12 years",
                qualification: "M.Tech in Computer Science",
                email: "vikram.singh@poornima.org",
                phone: "+91-141-2700530",
                specialization: ["Algorithms", "Data Structures", "Competitive Programming"],
                rating: 4.5,
                ratingCount: 312
            },
            {
                name: "Dr. Neha Gupta",
                role: "Assistant Professor",
                category: "faculty",
                department: "Computer Science & Engineering",
                emoji: "?????",
                experience: "8 years",
                qualification: "Ph.D. in Artificial Intelligence",
                email: "neha.gupta@poornima.org",
                phone: "+91-141-2700531",
                specialization: ["AI/ML", "Deep Learning", "Neural Networks"],
                rating: 4.8,
                ratingCount: 289
            },
            {
                name: "Prof. Rahul Jain",
                role: "Assistant Professor",
                category: "faculty",
                department: "Computer Science & Engineering",
                emoji: "?????",
                experience: "10 years",
                qualification: "M.Tech in Software Engineering",
                email: "rahul.jain@poornima.org",
                phone: "+91-141-2700532",
                specialization: ["Web Development", "Software Engineering", "DevOps"],
                rating: 4.6,
                ratingCount: 276
            },

            // Faculty Members - ECE
            {
                name: "Dr. Kavita Sharma",
                role: "Associate Professor",
                category: "faculty",
                department: "Electronics & Communication",
                emoji: "?????",
                experience: "14 years",
                qualification: "Ph.D. in Communication Systems",
                email: "kavita.sharma@poornima.org",
                phone: "+91-141-2700540",
                specialization: ["Wireless Communication", "5G Networks", "IoT"],
                rating: 4.7,
                ratingCount: 203
            },
            {
                name: "Prof. Anil Kumar",
                role: "Assistant Professor",
                category: "faculty",
                department: "Electronics & Communication",
                emoji: "?????",
                experience: "9 years",
                qualification: "M.Tech in VLSI Design",
                email: "anil.kumar@poornima.org",
                phone: "+91-141-2700541",
                specialization: ["Digital Electronics", "Microprocessors", "VLSI"],
                rating: 4.5,
                ratingCount: 187
            },

            // Faculty Members - Mechanical
            {
                name: "Prof. Deepak Choudhary",
                role: "Associate Professor",
                category: "faculty",
                department: "Mechanical Engineering",
                emoji: "?????",
                experience: "13 years",
                qualification: "M.Tech in Thermal Engineering",
                email: "deepak.c@poornima.org",
                phone: "+91-141-2700550",
                specialization: ["Heat Transfer", "Thermodynamics", "Energy Systems"],
                rating: 4.6,
                ratingCount: 165
            },
            {
                name: "Dr. Pooja Meena",
                role: "Assistant Professor",
                category: "faculty",
                department: "Mechanical Engineering",
                emoji: "?????",
                experience: "7 years",
                qualification: "Ph.D. in Manufacturing",
                email: "pooja.meena@poornima.org",
                phone: "+91-141-2700551",
                specialization: ["Manufacturing Processes", "Quality Control", "Automation"],
                rating: 4.7,
                ratingCount: 154
            },

            // Faculty Members - Civil
            {
                name: "Prof. Suresh Patel",
                role: "Associate Professor",
                category: "faculty",
                department: "Civil Engineering",
                emoji: "?????",
                experience: "11 years",
                qualification: "M.Tech in Structural Engineering",
                email: "suresh.patel@poornima.org",
                phone: "+91-141-2700560",
                specialization: ["RCC Design", "Steel Structures", "Earthquake Engineering"],
                rating: 4.5,
                ratingCount: 143
            },

            // Admin Staff
            {
                name: "Mr. Ramesh Chand",
                role: "Registrar",
                category: "admin",
                department: "Administration",
                emoji: "??",
                experience: "22 years",
                qualification: "MBA in Administration",
                email: "registrar@poornima.org",
                phone: "+91-141-2700600",
                specialization: ["Academic Administration", "Student Affairs", "Compliance"],
                rating: 4.4,
                ratingCount: 98
            },
            {
                name: "Mrs. Sunita Devi",
                role: "Accounts Officer",
                category: "admin",
                department: "Finance",
                emoji: "??",
                experience: "15 years",
                qualification: "M.Com, CA",
                email: "accounts@poornima.org",
                phone: "+91-141-2700610",
                specialization: ["Financial Management", "Budgeting", "Auditing"],
                rating: 4.6,
                ratingCount: 76
            },
            {
                name: "Mr. Vijay Kumar",
                role: "HR Manager",
                category: "admin",
                department: "Human Resources",
                emoji: "??",
                experience: "12 years",
                qualification: "MBA in HR",
                email: "hr@poornima.org",
                phone: "+91-141-2700620",
                specialization: ["Recruitment", "Employee Relations", "Training & Development"],
                rating: 4.5,
                ratingCount: 82
            },
            {
                name: "Mrs. Rekha Sharma",
                role: "Librarian",
                category: "admin",
                department: "Library",
                emoji: "??",
                experience: "18 years",
                qualification: "M.Lib.Sc",
                email: "library@poornima.org",
                phone: "+91-141-2700630",
                specialization: ["Library Management", "Digital Resources", "Research Support"],
                rating: 4.7,
                ratingCount: 201
            },
            {
                name: "Mr. Ashok Meena",
                role: "IT Administrator",
                category: "admin",
                department: "IT Services",
                emoji: "???",
                experience: "10 years",
                qualification: "B.Tech in IT",
                email: "it.admin@poornima.org",
                phone: "+91-141-2700640",
                specialization: ["Network Management", "System Administration", "Cybersecurity"],
                rating: 4.6,
                ratingCount: 134
            },

            // Support Staff
            {
                name: "Mr. Mohan Lal",
                role: "Chief Security Officer",
                category: "support",
                department: "Security",
                emoji: "???",
                experience: "25 years",
                qualification: "Ex-Military Personnel",
                email: "security@poornima.org",
                phone: "+91-141-2700700",
                specialization: ["Campus Security", "Emergency Response", "Safety Protocols"],
                rating: 4.8,
                ratingCount: 167
            },
            {
                name: "Mr. Raju Singh",
                role: "Security Guard",
                category: "support",
                department: "Security",
                emoji: "??",
                experience: "8 years",
                qualification: "12th Pass, Security Training",
                email: "security.gate1@poornima.org",
                phone: "+91-141-2700701",
                specialization: ["Gate Management", "Visitor Control", "Night Patrol"],
                rating: 4.5,
                ratingCount: 89
            },
            {
                name: "Mr. Prakash Kumar",
                role: "Watchman",
                category: "support",
                department: "Security",
                emoji: "??",
                experience: "12 years",
                qualification: "10th Pass",
                email: "watchman@poornima.org",
                phone: "+91-141-2700702",
                specialization: ["Night Watch", "Building Security", "Rounds"],
                rating: 4.6,
                ratingCount: 72
            },
            {
                name: "Mr. Dinesh Chand",
                role: "Maintenance Supervisor",
                category: "support",
                department: "Maintenance",
                emoji: "??",
                experience: "20 years",
                qualification: "ITI - Electrician",
                email: "maintenance@poornima.org",
                phone: "+91-141-2700710",
                specialization: ["Electrical Work", "Plumbing", "General Repairs"],
                rating: 4.7,
                ratingCount: 95
            },
            {
                name: "Mr. Shankar Lal",
                role: "Electrician",
                category: "support",
                department: "Maintenance",
                emoji: "?",
                experience: "15 years",
                qualification: "ITI - Electrician",
                email: "electrician@poornima.org",
                phone: "+91-141-2700711",
                specialization: ["Electrical Maintenance", "Wiring", "Power Distribution"],
                rating: 4.6,
                ratingCount: 68
            },
            {
                name: "Mr. Ramesh Kumar",
                role: "Plumber",
                category: "support",
                department: "Maintenance",
                emoji: "??",
                experience: "10 years",
                qualification: "ITI - Plumber",
                email: "plumber@poornima.org",
                phone: "+91-141-2700712",
                specialization: ["Plumbing", "Water Supply", "Drainage Systems"],
                rating: 4.5,
                ratingCount: 54
            },
            {
                name: "Mr. Gopal Sharma",
                role: "Gardener",
                category: "support",
                department: "Maintenance",
                emoji: "??",
                experience: "18 years",
                qualification: "8th Pass, Horticulture Training",
                email: "gardener@poornima.org",
                phone: "+91-141-2700720",
                specialization: ["Landscaping", "Plant Care", "Garden Maintenance"],
                rating: 4.8,
                ratingCount: 112
            },
            {
                name: "Mrs. Kamla Devi",
                role: "Housekeeping Supervisor",
                category: "support",
                department: "Housekeeping",
                emoji: "??",
                experience: "14 years",
                qualification: "10th Pass",
                email: "housekeeping@poornima.org",
                phone: "+91-141-2700730",
                specialization: ["Cleaning Management", "Hygiene Standards", "Team Supervision"],
                rating: 4.7,
                ratingCount: 103
            },
            {
                name: "Mrs. Savita Devi",
                role: "Cleaner",
                category: "support",
                department: "Housekeeping",
                emoji: "??",
                experience: "7 years",
                qualification: "8th Pass",
                email: "cleaner1@poornima.org",
                phone: "+91-141-2700731",
                specialization: ["Classroom Cleaning", "Washroom Maintenance", "Floor Care"],
                rating: 4.6,
                ratingCount: 78
            },
            {
                name: "Mr. Rajesh Kumar",
                role: "Canteen Manager",
                category: "support",
                department: "Canteen",
                emoji: "???",
                experience: "16 years",
                qualification: "Hotel Management Diploma",
                email: "canteen@poornima.org",
                phone: "+91-141-2700740",
                specialization: ["Food Service", "Menu Planning", "Hygiene Management"],
                rating: 4.5,
                ratingCount: 245
            },
            {
                name: "Mr. Sunil Kumar",
                role: "Lab Assistant",
                category: "support",
                department: "Laboratory",
                emoji: "??",
                experience: "9 years",
                qualification: "B.Sc in Physics",
                email: "lab.assistant@poornima.org",
                phone: "+91-141-2700750",
                specialization: ["Lab Setup", "Equipment Maintenance", "Student Assistance"],
                rating: 4.6,
                ratingCount: 156
            },
            {
                name: "Mr. Mahesh Chand",
                role: "Driver",
                category: "support",
                department: "Transport",
                emoji: "??",
                experience: "13 years",
                qualification: "10th Pass, Valid Driving License",
                email: "transport@poornima.org",
                phone: "+91-141-2700760",
                specialization: ["Safe Driving", "Vehicle Maintenance", "Route Planning"],
                rating: 4.7,
                ratingCount: 91
            },
            {
                name: "Mr. Bharat Singh",
                role: "Peon",
                category: "support",
                department: "Administration",
                emoji: "??",
                experience: "11 years",
                qualification: "8th Pass",
                email: "peon@poornima.org",
                phone: "+91-141-2700770",
                specialization: ["Office Support", "Document Delivery", "General Assistance"],
                rating: 4.5,
                ratingCount: 67
            }
        ];

        // MOCK USER ROLE - In a real app this comes from Auth logic
        // Changing this value will toggle the UI state for testing
        // Options: 'admin', 'moderator', 'teacher', 'student'
        const CURRENT_USER_ROLE = document.body.getAttribute('data-role') || 'student';

        // Initialize permissions
        import { hasPermission } from '../../assets/js/core/rbac.js';


        // Initialize the page
        let currentFilter = 'all';
        let userRatings = JSON.parse(localStorage.getItem('facultyRatings') || '{}');

        function renderFacultyCards(filter = 'all', searchTerm = '') {
            const grid = document.getElementById('facultyGrid');
            const emptyState = document.getElementById('emptyState');

            let filteredData = facultyData;

            // Apply category filter
            if (filter !== 'all') {
                filteredData = filteredData.filter(person => person.category === filter);
            }

            // Apply search filter
            if (searchTerm) {
                const term = searchTerm.toLowerCase();
                filteredData = filteredData.filter(person =>
                    person.name.toLowerCase().includes(term) ||
                    person.role.toLowerCase().includes(term) ||
                    person.department.toLowerCase().includes(term) ||
                    person.specialization.some(spec => spec.toLowerCase().includes(term))
                );
            }

            // Show/hide empty state
            if (filteredData.length === 0) {
                grid.style.display = 'none';
                emptyState.style.display = 'block';
                return;
            } else {
                grid.style.display = 'grid';
                emptyState.style.display = 'none';
            }

            // Render cards
            grid.innerHTML = filteredData.map((person, index) => {
                const userRating = userRatings[person.email] || 0;
                return `
                    <div class="faculty-card" style="animation-delay: ${index * 0.05}s">
                        <div class="category-badge">${person.category.toUpperCase()}</div>
                        <div class="card-header">
                            <div class="faculty-avatar"><img src="https://ui-avatars.com/api/?name=${encodeURIComponent(person.name)}&size=200&background=667eea&color=fff&bold=true" alt="${person.name}"></div>
                            <h2 class="faculty-name">${person.name}</h2>
                            <p class="faculty-role">${person.role}</p>
                        </div>
                        <div class="card-body">
                            <div class="info-section">
                                <div class="info-label">?? Department</div>
                                <div class="info-value">${person.department}</div>
                            </div>
                            
                            <div class="info-section">
                                <div class="info-label">?? Qualification</div>
                                <div class="info-value highlight">${person.qualification}</div>
                            </div>
                            
                            <div class="info-section">
                                <div class="info-label">?? Experience</div>
                                <div class="info-value">${person.experience}</div>
                            </div>
                            
                            <div class="info-section">
                                <div class="info-label">?? Specialization</div>
                                <div class="tags">
                                    ${person.specialization.map(spec => `<span class="tag">${spec}</span>`).join('')}
                                </div>
                            </div>
                            
                            <div class="rating-section" style="${!hasPermission([CURRENT_USER_ROLE], 'faculty.rate') ? 'display:none;' : ''}">
                                <div class="rating-header">
                                    <span class="rating-label">Overall Rating</span>
                                    <span class="rating-score">${person.rating.toFixed(1)}/5.0</span>
                                </div>
                                <div class="stars" data-email="${person.email}">
                                    ${[1, 2, 3, 4, 5].map(star => `
                                        <span class="star ${star <= userRating ? 'active' : ''}" data-rating="${star}">?</span>
                                    `).join('')}
                                </div>
                                <div class="rating-count">${person.ratingCount} ratings</div>
                                <button class="rate-btn" onclick="submitRating('${person.email}')">
                                    ${userRating > 0 ? 'Update Rating' : 'Rate Now'}
                                </button>
                            </div>

                            <!-- Edit Controls (Admin/Mod Only) -->
                             <div class="edit-section" style="${!hasPermission([CURRENT_USER_ROLE], 'faculty.edit') ? 'display:none;' : 'margin-top:1rem; border-top:1px solid #e2e8f0; padding-top:1rem;'}">
                                <button class="contact-btn" style="width:100%; justify-content:center; background:#f1f5f9; color:#475569;" onclick="alert('Edit Faculty: ${person.name}')">
                                    ?? Edit Details
                                </button>
                            </div>
                            
                            <div class="contact-section">
                                <button class="contact-btn" onclick="window.location.href='mailto:${person.email}'">
                                    ?? Email
                                </button>
                                <button class="contact-btn" onclick="window.location.href='tel:${person.phone}'">
                                    ?? Call
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            // Add star click handlers
            document.querySelectorAll('.stars').forEach(starsContainer => {
                starsContainer.querySelectorAll('.star').forEach(star => {
                    star.addEventListener('click', function () {
                        const rating = parseInt(this.dataset.rating);
                        const email = starsContainer.dataset.email;

                        // Update visual feedback
                        starsContainer.querySelectorAll('.star').forEach((s, idx) => {
                            if (idx < rating) {
                                s.classList.add('active');
                            } else {
                                s.classList.remove('active');
                            }
                        });

                        // Store rating temporarily
                        userRatings[email] = rating;
                    });
                });
            });
        }

        // Submit rating function
        function submitRating(email) {
            const rating = userRatings[email];
            if (!rating) {
                alert('Please select a rating first!');
                return;
            }

            // Save to localStorage
            localStorage.setItem('facultyRatings', JSON.stringify(userRatings));

            // Show success message
            alert('Thank you for your rating! Your feedback has been recorded.');
        }

        // Filter button handlers
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', function () {
                // Update active state
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');

                // Apply filter
                currentFilter = this.dataset.category;
                const searchTerm = document.getElementById('searchInput').value;
                renderFacultyCards(currentFilter, searchTerm);
            });
        });

        // Search handler
        document.getElementById('searchInput').addEventListener('input', function (e) {
            renderFacultyCards(currentFilter, e.target.value);
        });

        // Initial render
        renderFacultyCards();
    </script>
</body>

</html>
