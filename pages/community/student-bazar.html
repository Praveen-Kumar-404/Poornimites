<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Student Bazaar - Poornimites</title>
  <link rel="stylesheet" href="../../assets/css/core/style.css">
  <link rel="stylesheet" href="../../assets/css/core/header.css">
  <link rel="stylesheet" href="../../assets/css/core/footer.css">
  <link rel="stylesheet" href="../../assets/css/modules/community/student-bazaar.css">
</head>

<body>
  <div id="header-placeholder"></div>
  <script src="/scripts/header-loader.js?v=2.0"></script>

  <main class="bazaar-container">
    <!-- Page Header with Stats -->
    <div class="bazaar-header">
      <div class="header-content">
        <h1>??? Student Bazaar</h1>
        <p class="subtitle">Buy • Sell • Exchange • Find Roommates</p>
      </div>
      <div class="quick-stats">
        <div class="stat-item">
          <span class="stat-value" id="activeListings">0</span>
          <span class="stat-label">Active Listings</span>
        </div>
        <div class="stat-item">
          <span class="stat-value" id="soldToday">0</span>
          <span class="stat-label">Sold Today</span>
        </div>
        <div class="stat-item">
          <span class="stat-value" id="verifiedUsers">0</span>
          <span class="stat-label">Verified Users</span>
        </div>
      </div>
    </div>

    <!-- Navigation Tabs -->
    <nav class="bazaar-tabs" role="tablist">
      <button class="tab-btn active" data-tab="books" role="tab" aria-selected="true">
        ?? Books
      </button>
      <button class="tab-btn" data-tab="gadgets" role="tab" aria-selected="false">
        ?? Gadgets
      </button>
      <button class="tab-btn" data-tab="other" role="tab" aria-selected="false">
        ?? Other Items
      </button>
      <button class="tab-btn" data-tab="roommates" role="tab" aria-selected="false">
        ?? Roommates
      </button>
      <button class="tab-btn" data-tab="my-listings" role="tab" aria-selected="false">
        ?? My Listings
      </button>
    </nav>

    <!-- Search Bar -->
    <div class="search-container">
      <div class="search-wrapper">
        <input type="text" id="searchInput" class="search-input"
          placeholder="Search by title, author, brand, location..." aria-label="Search listings" />
        <button class="search-btn" aria-label="Search">??</button>
      </div>
      <button class="filter-toggle-btn" id="filterToggle" aria-label="Toggle filters">
        ?? Filters
      </button>
    </div>

    <div class="bazaar-content">
      <!-- Filter Panel -->
      <aside class="filter-panel" id="filterPanel">
        <div class="filter-header">
          <h3>Filters</h3>
          <button class="filter-close" id="filterClose" aria-label="Close filters">?</button>
        </div>

        <div class="filter-section">
          <label class="filter-label">Price Range</label>
          <div class="price-inputs">
            <input type="number" id="minPrice" placeholder="Min" min="0" aria-label="Minimum price">
            <span>—</span>
            <input type="number" id="maxPrice" placeholder="Max" min="0" aria-label="Maximum price">
          </div>
        </div>

        <div class="filter-section" id="conditionFilter">
          <label class="filter-label">Condition</label>
          <div class="checkbox-group">
            <label><input type="checkbox" value="new"> New</label>
            <label><input type="checkbox" value="like-new"> Like New</label>
            <label><input type="checkbox" value="used"> Used</label>
            <label><input type="checkbox" value="heavily-used"> Heavily Used</label>
          </div>
        </div>

        <div class="filter-section" id="categoryFilter">
          <label class="filter-label">Category</label>
          <select id="categorySelect" aria-label="Select category">
            <option value="">All Categories</option>
          </select>
        </div>

        <div class="filter-section">
          <label class="filter-label">Location Radius (km)</label>
          <input type="range" id="radiusSlider" min="1" max="50" value="10" aria-label="Location radius">
          <span id="radiusValue">10 km</span>
        </div>

        <div class="filter-section">
          <label class="filter-label">Sort By</label>
          <select id="sortSelect" aria-label="Sort listings">
            <option value="newest">Newest First</option>
            <option value="price-low">Price: Low to High</option>
            <option value="price-high">Price: High to Low</option>
            <option value="distance">Nearest First</option>
          </select>
        </div>

        <div class="filter-actions">
          <button class="btn-secondary" id="clearFilters">Clear All</button>
          <button class="btn-primary" id="applyFilters">Apply</button>
        </div>
      </aside>

      <!-- Main Content Area -->
      <div class="listings-container">
        <!-- Tab Content: Books -->
        <div class="tab-content active" id="books-content" role="tabpanel">
          <div class="listings-grid" id="booksGrid">
            <!-- Listings will be dynamically inserted here -->
          </div>
        </div>

        <!-- Tab Content: Gadgets -->
        <div class="tab-content" id="gadgets-content" role="tabpanel">
          <div class="listings-grid" id="gadgetsGrid">
            <!-- Listings will be dynamically inserted here -->
          </div>
        </div>

        <!-- Tab Content: Other Items -->
        <div class="tab-content" id="other-content" role="tabpanel">
          <div class="listings-grid" id="otherGrid">
            <!-- Listings will be dynamically inserted here -->
          </div>
        </div>

        <!-- Tab Content: Roommates -->
        <div class="tab-content" id="roommates-content" role="tabpanel">
          <div class="listings-grid" id="roommatesGrid">
            <!-- Listings will be dynamically inserted here -->
          </div>
        </div>

        <!-- Tab Content: My Listings -->
        <div class="tab-content" id="my-listings-content" role="tabpanel">
          <div class="my-listings-dashboard">
            <div class="dashboard-header">
              <h2>My Listings</h2>
              <div class="listing-tabs">
                <button class="listing-tab-btn active" data-status="active">Active</button>
                <button class="listing-tab-btn" data-status="sold">Sold</button>
                <button class="listing-tab-btn" data-status="closed">Closed</button>
              </div>
            </div>
            <div class="listings-grid" id="myListingsGrid">
              <!-- User's listings will be dynamically inserted here -->
            </div>
          </div>
        </div>

        <!-- Empty State -->
        <div class="empty-state" id="emptyState" style="display: none;">
          <div class="empty-icon">??</div>
          <h3>No listings found</h3>
          <p>Be the first to post something!</p>
          <button class="btn-primary" onclick="openCreateModal()">Post a Listing</button>
        </div>

        <!-- Loading State -->
        <div class="loading-state" id="loadingState" style="display: none;">
          <div class="skeleton-card"></div>
          <div class="skeleton-card"></div>
          <div class="skeleton-card"></div>
          <div class="skeleton-card"></div>
        </div>
      </div>
    </div>
  </main>

  <!-- Floating Action Button -->
  <button class="fab" id="createListingBtn" aria-label="Post a listing">
    <span class="fab-icon">+</span>
  </button>

  <!-- Modal: Create/Edit Listing -->
  <div class="modal" id="createModal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="modalTitle">Post a Listing</h2>
        <button class="modal-close" aria-label="Close modal">?</button>
      </div>
      <div class="modal-body">
        <form id="listingForm">
          <div class="form-step active" data-step="1">
            <div class="form-group">
              <label for="listingCategory">Category *</label>
              <select id="listingCategory" required>
                <option value="">Select a category</option>
                <option value="books">Books</option>
                <option value="gadgets">Gadgets</option>
                <option value="other">Other Items</option>
                <option value="roommate">Roommate</option>
              </select>
            </div>
          </div>

          <div class="form-step" data-step="2">
            <div id="dynamicFields">
              <!-- Fields will be dynamically inserted based on category -->
            </div>

            <div class="form-group">
              <label for="listingImages">Images *</label>
              <input type="file" id="listingImages" accept="image/*" multiple>
              <div class="image-preview" id="imagePreview"></div>
            </div>
          </div>

          <div class="form-navigation">
            <button type="button" class="btn-secondary" id="prevStep" style="display: none;">Previous</button>
            <button type="button" class="btn-primary" id="nextStep">Next</button>
            <button type="submit" class="btn-primary" id="submitListing" style="display: none;">Post Listing</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Modal: Listing Detail -->
  <div class="modal" id="detailModal" role="dialog" aria-modal="true">
    <div class="modal-content modal-large">
      <div class="modal-header">
        <h2 id="detailTitle">Listing Details</h2>
        <button class="modal-close" aria-label="Close modal">?</button>
      </div>
      <div class="modal-body" id="detailContent">
        <!-- Detail content will be dynamically inserted -->
      </div>
    </div>
  </div>

  <!-- Modal: Message Seller -->
  <div class="modal" id="messageModal" role="dialog" aria-modal="true">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Message Seller</h2>
        <button class="modal-close" aria-label="Close modal">?</button>
      </div>
      <div class="modal-body">
        <div class="message-interface">
          <div class="message-thread" id="messageThread">
            <p class="info-message">Start a conversation with the seller</p>
          </div>
          <div class="message-input-container">
            <textarea id="messageInput" placeholder="Type your message..." rows="3"></textarea>
            <button class="btn-primary" id="sendMessage">Send</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal: Report Listing -->
  <div class="modal" id="reportModal" role="dialog" aria-modal="true">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Report Listing</h2>
        <button class="modal-close" aria-label="Close modal">?</button>
      </div>
      <div class="modal-body">
        <form id="reportForm">
          <div class="form-group">
            <label>Reason for reporting *</label>
            <div class="radio-group">
              <label><input type="radio" name="reportReason" value="spam"> Spam or misleading</label>
              <label><input type="radio" name="reportReason" value="inappropriate"> Inappropriate content</label>
              <label><input type="radio" name="reportReason" value="scam"> Suspected scam</label>
              <label><input type="radio" name="reportReason" value="sold"> Already sold</label>
              <label><input type="radio" name="reportReason" value="other"> Other</label>
            </div>
          </div>
          <div class="form-group">
            <label for="reportDetails">Additional details</label>
            <textarea id="reportDetails" rows="4" placeholder="Please provide more information..."></textarea>
          </div>
          <div class="form-actions">
            <button type="button" class="btn-secondary modal-close">Cancel</button>
            <button type="submit" class="btn-primary">Submit Report</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <footer class="footer">
    <div class="footer-links">
      <a href="../site/about.html">About</a>
      <a href="../site/faq.html">FAQ</a>
      <a href="../site/roadmap.html">Roadmap</a>
      <a href="../site/privacy.html">Privacy</a>
      <a href="../site/credits.html">Credits</a>
    </div>
    <div class="footer-text">
      Made with ?? by Students for Students. © 2025 Poornimites
    </div>
  </footer>

  <script src="../../assets/js/core/main.js"></script>
  <script src="../../assets/js/modules/community/student-bazaar.js"></script>
</body>

</html>

