<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Timetable - Poornimites Toolkit</title>
    <link rel="stylesheet" href="../../assets/css/core/style.css">
    <link rel="stylesheet" href="../../assets/css/core/header.css">
    <link rel="stylesheet" href="../../assets/css/core/footer.css">
    <link rel="stylesheet" href="../../assets/css/modules/tools/toolkit.css">
    <style>
        .timetable-grid {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 12px var(--toolkit-shadow);
            overflow-x: auto;
        }

        .timetable-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }

        .timetable-table th,
        .timetable-table td {
            border: 1px solid var(--toolkit-border);
            padding: 0.75rem;
            text-align: center;
        }

        .timetable-table th {
            background: var(--toolkit-primary);
            color: white;
            font-weight: 600;
        }

        .timetable-table td {
            min-height: 80px;
            vertical-align: top;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .timetable-table td:hover {
            background: var(--toolkit-light);
        }

        .time-slot {
            background: var(--toolkit-light);
            font-weight: 600;
        }

        .class-entry {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 0.5rem;
            border-radius: 6px;
            font-size: 0.9rem;
            margin: 0.25rem 0;
        }

        .class-name {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .class-room {
            font-size: 0.8rem;
            opacity: 0.9;
        }

        .color-picker {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .color-option {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .color-option.selected {
            border-color: var(--toolkit-dark);
        }
    </style>
</head>

<body>
    <div id="header-placeholder"></div>
  <script src="/scripts/header-loader.js"></script>

    <main class="toolkit-container">
        <div class="toolkit-header">
            <h1>🗓️ Timetable</h1>
            <p>Create and manage your class schedule</p>
        </div>

        <div class="tool-section">
            <div class="d-flex justify-between align-center mb-3">
                <h2>Weekly Schedule</h2>
                <div class="d-flex gap-2">
                    <button class="btn btn-secondary" onclick="timetable.exportToPDF()">📥 Export PDF</button>
                    <button class="btn btn-secondary" onclick="timetable.clearAll()">🗑️ Clear All</button>
                </div>
            </div>

            <div class="timetable-grid">
                <table class="timetable-table" id="timetableTable">
                    <thead>
                        <tr>
                            <th>Time</th>
                            <th>Monday</th>
                            <th>Tuesday</th>
                            <th>Wednesday</th>
                            <th>Thursday</th>
                            <th>Friday</th>
                            <th>Saturday</th>
                        </tr>
                    </thead>
                    <tbody id="timetableBody"></tbody>
                </table>
            </div>
        </div>
    </main>

    <!-- Modal for adding class -->
    <div class="modal" id="classModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add Class</h2>
                <button class="modal-close" onclick="ToolkitUtils.modal.close('classModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Subject Name</label>
                    <input type="text" id="className" class="form-control" placeholder="e.g., Mathematics">
                </div>

                <div class="form-group">
                    <label class="form-label">Faculty Name</label>
                    <input type="text" id="facultyName" class="form-control" placeholder="e.g., Dr. Smith">
                </div>

                <div class="form-group">
                    <label class="form-label">Room Number</label>
                    <input type="text" id="roomNumber" class="form-control" placeholder="e.g., Room 101">
                </div>

                <div class="form-group">
                    <label class="form-label">Color</label>
                    <div class="color-picker">
                        <div class="color-option selected"
                            style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"
                            data-color="linear-gradient(135deg, #667eea 0%, #764ba2 100%)"></div>
                        <div class="color-option" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);"
                            data-color="linear-gradient(135deg, #f093fb 0%, #f5576c 100%)"></div>
                        <div class="color-option" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);"
                            data-color="linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)"></div>
                        <div class="color-option" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);"
                            data-color="linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)"></div>
                        <div class="color-option" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);"
                            data-color="linear-gradient(135deg, #fa709a 0%, #fee140 100%)"></div>
                        <div class="color-option" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);"
                            data-color="linear-gradient(135deg, #30cfd0 0%, #330867 100%)"></div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="timetable.saveClass()">Save</button>
                <button class="btn btn-secondary" onclick="ToolkitUtils.modal.close('classModal')">Cancel</button>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-links">
            <a href="../site/about.html">About</a>
            <a href="../site/faq.html">FAQ</a>
            <a href="../site/privacy.html">Privacy</a>
        </div>
        <div class="footer-text">
            Made with 💙 by Students for Students. © 2025 Poornimites
        </div>
    </footer>

    <script src="../../assets/js/modules/tools/toolkit-common.js"></script>
    <script>
        const timetable = {
            schedule: {},
            currentSlot: null,
            selectedColor: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',

            timeSlots: [
                '08:00 - 09:00',
                '09:00 - 10:00',
                '10:00 - 11:00',
                '11:00 - 12:00',
                '12:00 - 01:00',
                '01:00 - 02:00',
                '02:00 - 03:00',
                '03:00 - 04:00',
                '04:00 - 05:00'
            ],

            days: ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],

            init() {
                this.loadSchedule();
                this.renderTimetable();
                this.setupColorPicker();
            },

            renderTimetable() {
                const tbody = document.getElementById('timetableBody');

                tbody.innerHTML = this.timeSlots.map((time, timeIndex) => `
                <tr>
                    <td class="time-slot">${time}</td>
                    ${this.days.map((day, dayIndex) => {
                    const slotKey = `${dayIndex}-${timeIndex}`;
                    const classData = this.schedule[slotKey];

                    return `
                            <td onclick="timetable.openClassModal(${dayIndex}, ${timeIndex})">
                                ${classData ? `
                                    <div class="class-entry" style="background: ${classData.color}">
                                        <div class="class-name">${classData.name}</div>
                                        ${classData.faculty ? `<div class="class-room">👤 ${classData.faculty}</div>` : ''}
                                        ${classData.room ? `<div class="class-room">📍 ${classData.room}</div>` : ''}
                                    </div>
                                ` : '<span style="color: #ccc;">+</span>'}
                            </td>
                        `;
                }).join('')}
                </tr>
            `).join('');
            },

            openClassModal(dayIndex, timeIndex) {
                this.currentSlot = `${dayIndex}-${timeIndex}`;

                const existing = this.schedule[this.currentSlot];
                if (existing) {
                    document.getElementById('className').value = existing.name;
                    document.getElementById('facultyName').value = existing.faculty || '';
                    document.getElementById('roomNumber').value = existing.room || '';
                    this.selectedColor = existing.color;

                    // Update color picker
                    document.querySelectorAll('.color-option').forEach(opt => {
                        opt.classList.toggle('selected', opt.dataset.color === this.selectedColor);
                    });
                } else {
                    document.getElementById('className').value = '';
                    document.getElementById('facultyName').value = '';
                    document.getElementById('roomNumber').value = '';
                }

                ToolkitUtils.modal.open('classModal');
            },

            saveClass() {
                const name = document.getElementById('className').value.trim();

                if (!name) {
                    ToolkitUtils.showToast('Please enter a subject name', 'warning');
                    return;
                }

                this.schedule[this.currentSlot] = {
                    name,
                    faculty: document.getElementById('facultyName').value.trim(),
                    room: document.getElementById('roomNumber').value.trim(),
                    color: this.selectedColor
                };

                this.saveSchedule();
                this.renderTimetable();
                ToolkitUtils.modal.close('classModal');
                ToolkitUtils.showToast('Class added!', 'success');
            },

            setupColorPicker() {
                document.querySelectorAll('.color-option').forEach(option => {
                    option.addEventListener('click', () => {
                        document.querySelectorAll('.color-option').forEach(opt => {
                            opt.classList.remove('selected');
                        });
                        option.classList.add('selected');
                        this.selectedColor = option.dataset.color;
                    });
                });
            },

            exportToPDF() {
                window.print();
            },

            clearAll() {
                if (confirm('Clear entire timetable?')) {
                    this.schedule = {};
                    this.saveSchedule();
                    this.renderTimetable();
                    ToolkitUtils.showToast('Timetable cleared', 'info');
                }
            },

            saveSchedule() {
                ToolkitUtils.storage.save('timetable_data', this.schedule);
            },

            loadSchedule() {
                this.schedule = ToolkitUtils.storage.load('timetable_data', {});
            }
        };

        // Initialize
        timetable.init();
    </script>
</body>

</html>


