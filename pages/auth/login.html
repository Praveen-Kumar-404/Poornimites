<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Authentication - Poornimites</title>
    <link rel="stylesheet" href="../../assets/css/modules/auth/auth.css">
</head>

<body>
    <div id="header-placeholder"></div>
  <script src="/scripts/header-loader.js?v=2.0"></script>

    <div class="auth-container">
        <div class="auth-card">
            <!-- Tab Toggle -->
            <div class="auth-tabs">
                <button class="auth-tab active" id="login-tab">Login</button>
                <button class="auth-tab" id="signup-tab">Sign Up</button>
            </div>

            <div class="auth-header">
                <div class="auth-logo">ðŸ‘¤</div>
                <h1 class="auth-title" id="auth-title">Welcome Back!</h1>
                <p class="auth-subtitle" id="auth-subtitle">Sign in to continue to Poornimites</p>
            </div>

            <div id="error-message" class="error-message"></div>

            <!-- Google Sign-In (Centered) -->
            <div class="google-signin-container">
                <button class="btn btn-google" id="google-signin-btn">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M19.8055 10.2292C19.8055 9.55056 19.7501 8.86667 19.6306 8.19861H10.2V12.0486H15.6014C15.3773 13.2911 14.6571 14.3898 13.6025 15.0875V17.5861H16.825C18.7173 15.8444 19.8055 13.2722 19.8055 10.2292Z"
                            fill="#4285F4" />
                        <path
                            d="M10.2 20C12.9573 20 15.2765 19.1056 16.8292 17.5861L13.6067 15.0875C12.7059 15.6972 11.5518 16.0433 10.2042 16.0433C7.54165 16.0433 5.28267 14.2833 4.48165 11.9097H1.15833V14.4819C2.74556 17.6444 6.31389 20 10.2 20Z"
                            fill="#34A853" />
                        <path
                            d="M4.47733 11.9097C4.05733 10.6672 4.05733 9.33778 4.47733 8.09528V5.52306H1.15822C-0.386111 8.59167 -0.386111 12.4133 1.15822 15.4819L4.47733 11.9097Z"
                            fill="#FBBC04" />
                        <path
                            d="M10.2 3.95667C11.6255 3.93556 13.0004 4.47222 14.0409 5.45889L16.8933 2.60667C15.1838 0.990556 12.9375 0.0822222 10.2 0.105C6.31389 0.105 2.74556 2.46056 1.15833 5.52306L4.47745 8.09528C5.27422 5.71639 7.53744 3.95667 10.2 3.95667Z"
                            fill="#EA4335" />
                    </svg>
                    <span>Continue with Google</span>
                </button>
            </div>

            <div class="divider">
                <span>OR</span>
            </div>

            <!-- Login Form -->
            <form class="auth-form" id="login-form">
                <div class="form-group">
                    <label for="login-email" class="form-label">Email Address</label>
                    <input type="email" id="login-email" name="email" class="form-input"
                        placeholder="your.name@poornima.edu.in" required autocomplete="email">
                </div>

                <div class="form-group">
                    <label for="login-password" class="form-label">Password</label>
                    <input type="password" id="login-password" name="password" class="form-input"
                        placeholder="Enter your password" required autocomplete="current-password">
                </div>

                <button type="submit" class="btn btn-primary" id="login-btn">
                    <span>Sign In</span>
                </button>
            </form>

            <!-- Signup Form (Hidden by default) -->
            <form class="auth-form" id="signup-form" style="display: none;">
                <div class="form-group">
                    <label for="signup-username" class="form-label">Username</label>
                    <input type="text" id="signup-username" name="username" class="form-input" placeholder="Your name"
                        autocomplete="name">
                </div>

                <div class="form-group">
                    <label for="signup-email" class="form-label">Email Address</label>
                    <input type="email" id="signup-email" name="email" class="form-input"
                        placeholder="your.name@poornima.edu.in" autocomplete="email">
                    <small>Only @poornima.edu.in emails are allowed</small>
                </div>

                <div class="form-group">
                    <label for="signup-password" class="form-label">Password</label>
                    <input type="password" id="signup-password" name="password" class="form-input"
                        placeholder="At least 6 characters" autocomplete="new-password" minlength="6">
                </div>

                <div class="form-group">
                    <label for="signup-confirm-password" class="form-label">Confirm Password</label>
                    <input type="password" id="signup-confirm-password" name="confirm-password" class="form-input"
                        placeholder="Re-enter your password" autocomplete="new-password" minlength="6">
                </div>

                <button type="submit" class="btn btn-primary" id="signup-btn">
                    <span>Create Account</span>
                </button>
            </form>
        </div>

        <div class="back-home">
            <a href="../../index.html">? Back to Home</a>
        </div>
    </div>

    <script type="module">
        import { handleLogin, handleSignup, handleGoogleSignIn } from '../../assets/js/modules/auth/auth-handler.js';

        // Wait for DOM to be fully loaded
        document.addEventListener('DOMContentLoaded', function () {
            const loginTab = document.getElementById('login-tab');
            const signupTab = document.getElementById('signup-tab');
            const loginForm = document.getElementById('login-form');
            const signupForm = document.getElementById('signup-form');
            const authTitle = document.getElementById('auth-title');
            const authSubtitle = document.getElementById('auth-subtitle');

            // Tab switching
            loginTab.addEventListener('click', () => {
                loginTab.classList.add('active');
                signupTab.classList.remove('active');
                loginForm.style.display = 'flex';
                signupForm.style.display = 'none';
                authTitle.textContent = 'Welcome Back!';
                authSubtitle.textContent = 'Sign in to continue to Poornimites';
            });

            signupTab.addEventListener('click', () => {
                signupTab.classList.add('active');
                loginTab.classList.remove('active');
                signupForm.style.display = 'flex';
                loginForm.style.display = 'none';
                authTitle.textContent = 'Join Poornimites';
                authSubtitle.textContent = 'Create your account to get started';
            });

            // Show error message
            function showError(message) {
                const errorDiv = document.getElementById('error-message');
                errorDiv.textContent = message;
                errorDiv.classList.add('show');
                setTimeout(() => {
                    errorDiv.classList.remove('show');
                }, 5000);
            }

            // Handle login form submission
            loginForm.addEventListener('submit', async (e) => {
                e.preventDefault();

                const email = document.getElementById('login-email').value.trim();
                const password = document.getElementById('login-password').value;
                const loginBtn = document.getElementById('login-btn');

                await handleLogin(email, password, loginBtn);
            });

            // Handle signup form submission
            signupForm.addEventListener('submit', async (e) => {
                e.preventDefault();

                const username = document.getElementById('signup-username').value.trim();
                const email = document.getElementById('signup-email').value.trim();
                const password = document.getElementById('signup-password').value;
                const confirmPassword = document.getElementById('signup-confirm-password').value;
                const signupBtn = document.getElementById('signup-btn');

                // Validate passwords match
                if (password !== confirmPassword) {
                    showError("Passwords do not match.");
                    return;
                }

                await handleSignup(email, password, username, signupBtn);
            });

            // Handle Google sign-in
            document.getElementById('google-signin-btn').addEventListener('click', async () => {
                const googleBtn = document.getElementById('google-signin-btn');
                await handleGoogleSignIn(googleBtn);
            });
        });
    </script>


</body>

</html>
